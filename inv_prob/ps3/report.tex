\documentclass[11pt]{article}
\usepackage{graphicx,amsmath,amsfonts,amssymb,graphicx} 
\usepackage[varg]{txfonts}
\usepackage{enumerate}
\usepackage{hyperref}
\usepackage{listings}
\usepackage{color}
\urlstyle{tt}
\usepackage{hyperref}
\usepackage{amsmath}
\usepackage{graphicx}
\usepackage{caption}
\usepackage{subcaption}
\usepackage[section]{placeins}
\renewcommand{\thesubsection}{\thesection.\alph{subsection}}
\usepackage{listings}
\usepackage{amssymb}
\usepackage{geometry}
\geometry{%
  letterpaper,
  lmargin=2cm,
  rmargin=2cm,
  tmargin=2cm,
  bmargin=2cm,
  footskip=12pt,
  headheight=12pt}
  


\usepackage{lastpage}
\usepackage{fancyhdr}

\title{\bf{CSE397: Assignment \#3}}
\author{Nicholas Malaya \\ Department of Mechanical Engineering \\
Institute for Computational Engineering and Sciences \\ University of
Texas at Austin} \date{} 


\def\squarebox#1{\hbox to #1{\hfill\vbox to #1{\vfill}}}
\def\qed{\hspace*{\fill}
        \vbox{\hrule\hbox{\vrule\squarebox{.667em}\vrule}\hrule}}
\newenvironment{solution}{\begin{trivlist}\item[]{\bf Solution:}}
                      {\qed \end{trivlist}}

\begin{document}
\maketitle
\newpage

\section*{ Problem 1}

\begin{enumerate}
\item [(A)] %PART A
For both $\mathcal{F}_{TN}$ and $\mathcal{F}_{TV}$ , derive the
      first-order necessary condition for optimality using calculus of
      variations, in both weak form and strong form. Use $\hat{u}$ to
      represent the variation of $u$. 

\begin{solution}
	To obtain the weak form for the Tikhonov regularization, take the variational derivative:
	\begin{align}
	\mathcal{F}_{TN}(u + \tau\hat{u}) &= \int_{\Omega}\left(u + \tau\hat{u} - u_0\right)^2d\mathbf{x}
		+ 0.5\int_{\Omega}
	 k(\mathbf{x})\nabla(u+\tau\hat{u})\cdot\nabla(u +
	 \tau\hat{u})d\mathbf{x}\nonumber \\ 
	\frac{d\mathcal{F}_{TN}}{d\tau} &= 2\int_{\Omega}\left(u + \tau\hat{u}-u_0\right)\hat{u}d\mathbf{x}
	    + \int_{\Omega} k(\mathbf{x})\nabla(u +
	 \tau\hat{u})\cdot\nabla\hat{u}d\mathbf{x}\nonumber\\ 
	\left.\frac{d\mathcal{F}_{TN}}{d\tau}\right|_{\tau=0} &=
	 2\int_{\Omega}\left(u -u_0\right)\hat{u}d\mathbf{x} +
	 \int_{\Omega} k(\mathbf{x})\nabla u
	 \cdot\nabla\hat{u}d\mathbf{x}\nonumber\\ 
    &= 0 \nonumber
	\end{align}
	Therefore the weak form for the Tikhonov regularization is given by:
	\begin{displaymath}
		2\int_{\Omega}\left(u -u_0\right)\hat{u}d\mathbf{x} + \int_{\Omega} k(\mathbf{x})\nabla u \cdot\nabla\hat{u}d\mathbf{x} = 0
	\end{displaymath}
	Then to obtain the strong form use Gauss Theorem:
	\begin{displaymath}
		2\int_{\Omega}\left(u -u_0\right)\hat{u}d\mathbf{x} - \int_{\Omega} \nabla \cdot (k(\mathbf{x})\nabla u)\hat{u}d\mathbf{x} + \int_{\Gamma} (k(\mathbf{x})\nabla u)\cdot n \hat{u}ds = 0 \hspace{1 cm} \forall\hat{u} \in H^1(\Omega)
	\end{displaymath}
	However it was prescribed that the Neumann condition on $u$ is zero, leaving:
	\begin{displaymath}
		2\int_{\Omega}\left(\left(u -u_0\right) - \nabla \cdot
	 (k(\mathbf{x})\nabla u)\right)\hat{u}d\mathbf{x}  = 0 \hspace{1
	 cm} \forall\hat{u} \in H^1(\Omega) 
	\end{displaymath}
	Since this is true for all variations $\hat{u}$ then the following strong form holds:
	\begin{align}
		2\left(u -u_0\right) - \nabla \cdot (k(\mathbf{x})\nabla u) &= 0 \nonumber \\
		\nabla u \cdot n &= 0 \nonumber
	\end{align} \\
	
	Following the same method for the modified total variational regularization:
	\begin{align}
	\mathcal{F}_{TV}^\epsilon(u + \tau\hat{u}) &= \int_{\Omega}\left(u + \tau\hat{u} - u_0\right)^2d\mathbf{x}
		+ \int_{\Omega}
	 k(\mathbf{x})\left(\nabla(u+\tau\hat{u})\cdot\nabla(u +
	 \tau\hat{u}) + \epsilon\right)^{0.5}d\mathbf{x}\nonumber \\ 
	\frac{d\mathcal{F}_{TV}^\epsilon}{d\tau} &= 2\int_{\Omega}\left(u + \tau\hat{u}-u_0\right)\hat{u}d\mathbf{x}
	    + \int_{\Omega} k(\mathbf{x})\frac{\left(\nabla(u+\tau\hat{u})\cdot\nabla\hat{u} \right)}{\sqrt{\left(\nabla(u+\tau\hat{u})\cdot\nabla(u + \tau\hat{u}) + \epsilon\right)}}d\mathbf{x}\nonumber\\
	\left.\frac{d\mathcal{F}_{TV}^\epsilon}{d\tau}\right|_{\tau=0}
	 &= 2\int_{\Omega}\left(u -u_0\right)\hat{u}d\mathbf{x} +
	 \int_{\Omega} k(\mathbf{x})\frac{\left(\nabla u
	 \cdot\nabla\hat{u} \right)}{\sqrt{\left(\nabla u\cdot\nabla u +
	 \epsilon\right)}}d\mathbf{x}\nonumber\\ 
    &= 0 \nonumber
	\end{align}
	This gives the weak form:
	\begin{displaymath}
	2\int_{\Omega}\left(u -u_0\right)\hat{u}d\mathbf{x} + \int_{\Omega} k(\mathbf{x})\frac{\left(\nabla u \cdot\nabla\hat{u} \right)}{\sqrt{\left(\nabla u\cdot\nabla u + \epsilon\right)}}d\mathbf{x} = 0 \hspace{1 cm} \forall\hat{u} \in H^1(\Omega) 
	\end{displaymath}
	The performing Gauss Theorem for the strong form:
	\begin{displaymath}
	2\int_{\Omega}\left(u -u_0\right)\hat{u}d\mathbf{x} 
	-\int_{\Omega} \nabla \cdot \left(k(\mathbf{x})\frac{\nabla
	 u}{\sqrt{\left(\nabla u\cdot\nabla u +
	 \epsilon\right)}}\right)\hat{u}d\mathbf{x} 
	+\int_{\Gamma} k(\mathbf{x})\hat{u}\frac{\nabla u \cdot n}{\sqrt{\left(\nabla u\cdot\nabla u + \epsilon\right)}}ds
	= 0 \hspace{1 cm} \forall\hat{u} \in H^1(\Omega) 
	\end{displaymath}
	Again the prescribed boundary condition on $\Gamma$ causes the boundary to be zero, leaving:
	\begin{displaymath}
	2\int_{\Omega}\left(u -u_0\right)\hat{u}
	- \nabla \cdot \left(k(\mathbf{x})\frac{\nabla
	 u}{\sqrt{\left(\nabla u\cdot\nabla u +
	 \epsilon\right)}}\right)\hat{u}d\mathbf{x} 
	= 0 \hspace{1 cm} \forall\hat{u} \in H^1(\Omega) 
	\end{displaymath}
	Since this holds for all variations $\hat{u}$ then the following strong form holds:
	\begin{align}
		2\left(u -u_0\right) - \nabla \cdot
	 \left(k(\mathbf{x})\frac{\nabla u}{\sqrt{\left(\nabla
	 u\cdot\nabla u + \epsilon\right)}}\right) &= 0 \nonumber\\ 
		\nabla u \cdot n &= 0 \nonumber
	\end{align}
\end{solution}

\item [(B)]%PART B
Show that when $\nabla u$ is zero, $\mathcal{R}_{TV}$ is not differentiable, but $\mathcal{R}^{\epsilon}_{TV}$ is.
\begin{solution}
	Performing the variational derivative of $\mathcal{R}_{TV}$ as done previously:
	\begin{align}
		\mathcal{R}_{TV}(u+\tau\hat{u}) &= \int_\Omega
	 k(\mathbf{x})\left(\nabla(u+\tau\hat{u}) \cdot
	 \nabla(u+\tau\hat{u})\right)^{0.5}d\mathbf{x} \nonumber \\ 
		\left.\frac{d\mathcal{R}_{TV}}{d\tau}(u+\tau\hat{u})\right|_{\tau = 0} &= \int_\Omega k(\mathbf{x})\frac{\nabla u \cdot \nabla\hat{u}}{\sqrt{\nabla u \cdot \nabla u}}d\mathbf{x} \nonumber
	\end{align}
	From here it is easy to see that a divide by 0 occurs if $\nabla
 u = 0$. Therefore the derivative of $\mathcal{R}_{TV}$ does not exist
 for $\nabla u = 0$. However for $\mathcal{R}^{\epsilon}_{TV}$, one has: 
	\begin{align}
		\mathcal{R}_{TV}^\epsilon(u+\tau\hat{u}) &= \int_\Omega k(\mathbf{x})\left(\nabla(u+\tau\hat{u}) \cdot \nabla(u+\tau\hat{u}) + \epsilon\right)^{0.5}d\mathbf{x} \nonumber \\
		\left.\frac{d\mathcal{R}^\epsilon_{TV}}{d\tau}(u+\tau\hat{u})\right|_{\tau
	 = 0} &= \int_\Omega k(\mathbf{x})\frac{\nabla u \cdot
	 \nabla\hat{u}}{\sqrt{\nabla u \cdot \nabla u +
	 \epsilon}}d\mathbf{x} \nonumber 
	\end{align}
	Then the derivative exists for $\nabla u = 0$ as the divide by 0
 is avoided due to the nonzero epsilon. 
\end{solution}

\item [(C)] %C
For both $\mathcal{F}_{TN}$ and $\mathcal{F}_{TV}^\epsilon$ , derive the
      infinite-dimensional Newton step, in both weak and strong
      form. For consistency of notation, please use $\tilde{u}$ as the
      differential of $u$ (i.e. the Newton step). The strong form of the
      second variation of $\mathcal{F}_{TV}^\epsilon$ will give an
      anisotropic diffusion operator of the form $-
      \nabla\cdot(A(u)\nabla \tilde{u})$, where $A(u)$ is an anisotropic
      tensor that plays the role of the diffusivity coefficient. (In
      contrast, you can think of the second variation of
      $\mathcal{F}_{TV}^\epsilon$ giving an isotropic diffusion
      operator, i.e. with $A = \alpha I$ for some $\alpha$.) 

\begin{solution}
	As shown in class the Newton step is given by:
	\begin{displaymath}
		\left.\frac{d\delta u\pi(u+\tau\tilde{u},\hat{u})}{d\tau}\right|_{\tau = 0} =
		-\left.\frac{d\pi(u+\tau\hat{u})}{d\tau}\right|_{\tau = 0}
	\end{displaymath}
	where the $\pi$ function will be either $\mathcal{F}_{TN}$ or
 $\mathcal{F}_{TV}^\epsilon$. However the left hand side needs to be
 evaluated for these cases. First for $\mathcal{F}_{TN}$: 
	\begin{align}
		\delta u\mathcal{F}_{TN}(u+\tau\tilde{u},\hat{u}) &=
		2\int_{\Omega}\left(u + \tau \tilde{u}
	 -u_0\right)\hat{u}d\mathbf{x} + \int_{\Omega}
	 k(\mathbf{x})\nabla(u+\tau\tilde{u})
	 \cdot\nabla\hat{u}d\mathbf{x} \\ 
		\frac{d
	 (\delta
	 u\mathcal{F}_{TN})}{d\tau}(u+\tau\tilde{u},\hat{u})|_{\tau =0} &=  
		2\int_{\Omega}\tilde{u}\hat{u}d\mathbf{x} +
	 \int_{\Omega} k(\mathbf{x})\nabla \tilde{u}
	 \cdot\nabla\hat{u}d\mathbf{x}
	\end{align}
The weak form is therefore, 
\begin{equation}
 2\int_{\Omega}\tilde{u}\hat{u}d\mathbf{x} +
  \int_{\Omega} k(\mathbf{x})\nabla \tilde{u}
  \cdot\nabla\hat{u}d\mathbf{x} = 2 \int_{\Omega}(u-u_0)\hat u dx +
  \int_{\Omega} k(x) \nabla u \cdot \hat u dx. 
\end{equation}

Then, $\mathcal{F}^{\epsilon}_{TV}$:
	\begin{align}
	 \delta u\mathcal{F}^{\epsilon}_{TV}(u+\tau\tilde{u},\hat{u}) &= 2\int_{\Omega}\left(u + \tau \tilde{u}
	 -u_0\right)\hat{u}d\mathbf{x} + \int_{\Omega} k(\mathbf{x})
	 \frac{\nabla(u+\tau\tilde{u})\cdot\nabla\hat{u}}{\sqrt{\nabla(u+\tau\tilde{u})\cdot\nabla(u+\tau\tilde{u})
	 +\epsilon}} dx \\ 
	 \frac{\delta
	 u\mathcal{F}^{\epsilon}_{TV}}{d\tau}(u+\tau\tilde{u},\hat{u})
	 &= 2\int_{\Omega}\tilde{u}\hat{u}d\mathbf{x}
	 + \int_{\Omega} k(\mathbf{x})
	 \frac{\nabla u \cdot\nabla\hat{u}}{\sqrt{\nabla(u+\tau\tilde{u})\cdot\nabla(u+\tau\tilde{u})
	 + \epsilon}} dx
	 - \int_{\Omega} k(\mathbf{x})\frac{
	 (\nabla (u+\tau \tilde u)\cdot \nabla \hat u) (\nabla (u+\tau
	 \tilde u)\cdot \nabla \tilde u)}
	 {(\sqrt{\nabla(u+\tau\tilde{u})\cdot\nabla(u+\tau\tilde{u}) 
	 + \epsilon)^{3/2}}} dx \\	 
	 \frac{\delta
	 u\mathcal{F}^{\epsilon}_{TV}}{d\tau}(u+\tau\tilde{u},\hat{u})
	 |_{\tau = 0} 
	 &= 2\int_{\Omega}\tilde{u}\hat{u}d\mathbf{x} +
	 \int_{\Omega} k(\mathbf{x})
	 \frac{\nabla \tilde u \cdot\nabla\hat{u}}{\sqrt{\nabla u \cdot
	 \nabla u +\epsilon}} dx
	 %
	 - \int_{\Omega} k(\mathbf{x})\frac{
	 (\nabla u \cdot \nabla u^T) (\nabla \tilde u \cdot \nabla \hat u)}
	 {(\sqrt{\nabla u \cdot\nabla u 
	 + \epsilon)^{3/2}}} dx 	
	\end{align}
The weak form is therefore, 
\begin{equation}
2\int_{\Omega}\tilde{u}\hat{u}d\mathbf{x} +
 \int_{\Omega} k(\mathbf{x})
 \frac{\nabla \tilde u \cdot\nabla\hat{u}}{\sqrt{\nabla u \cdot
 \nabla u +\epsilon}} dx
 %
 - \int_{\Omega} k(\mathbf{x})\frac{
 (\nabla u \cdot \nabla u^T) (\nabla \tilde u \cdot \nabla \hat u)}
 {(\sqrt{\nabla u \cdot\nabla u 
 + \epsilon)^{3/2}}} dx
 = 2 \int_{\Omega}(u-u_0)\hat u dx +  \int_{\Omega} k(\mathbf{x})
 \frac{\nabla u \cdot\nabla\hat{u}}{\sqrt{\nabla u \cdot
 \nabla u +\epsilon}} dx
\end{equation}

 We now have the weak forms for Newton steps of
 $\mathcal{F}_{TN}$ and $\mathcal{F}^{\epsilon}_{TV}$. Using Gauss'
 Theorem, and the condition that $\nabla \hat u \cdot n = 0$, we can
 regain the strong forms, namely: 
 \begin{align}
  2 \tilde u - \nabla \cdot (k(x)\nabla \tilde u) = 2(u-u_0) - \nabla
  \cdot (k(x)\nabla u)\\
  \nabla \hat u \cdot n = 0\\
 \end{align}
  and, 
 \begin{align}
  2 \tilde u - \nabla \cdot \left( \frac{k(x)}{(\nabla u \cdot \nabla +
  \epsilon)^{1/2}} \left( I - \frac{1}{\nabla u \cdot \nabla u +
  \epsilon} \nabla u \cdot \nabla u^T \right) \nabla \tilde u \right) =
  2(u=u_0) - \nabla \cdot \left( \frac{k(x)}{(\nabla u \cdot \nabla +
  \epsilon)^{1/2}} \nabla u \right) \\
  \nabla \hat u \cdot n = 0
\end{align}
 

\end{solution}
\end{enumerate}
%%%%%

\end{document}


